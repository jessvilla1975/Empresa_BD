
--Consultas
--1. Listado de Productos encargados pendientes por entregar (ordenados por fecha)
SELECT c.ID, p.fecha_encargo, p.Num_pedido, pt.Codigo, pt.Descripcion
FROM CLIENTE c
JOIN PEDIDO p ON c.ID = p.Id_Cliente
JOIN PRODUCTO_TERMINADO pt ON p.Num_pedido = pt.Num_pedido
WHERE p.Estado <> 'Entregado'
ORDER BY p.fecha_encargo ASC;

--2 Por cada cliente, listar los productos encargados que no han sido entregados

SELECT c.ID, c.Nombre, c.telefono, p.Num_pedido, pt.Codigo, pt.Descripcion
FROM CLIENTE c
JOIN PEDIDO p ON c.ID = p.Id_Cliente
JOIN PRODUCTO_TERMINADO pt ON p.Num_pedido = pt.Num_pedido
WHERE p.Estado <> 'Entregado'

--3 //revisar

SELECT 
    PT.Codigo, 
    PT.Descripcion, 
    (PT.Cantidad_Existente - IFNULL((SELECT SUM(PT2.Cantidad_Existente) FROM PRODUCTO_TERMINADO PT2 WHERE PT2.Num_pedido IN (SELECT Num_pedido FROM PEDIDO WHERE Estado = 'En proceso') AND PT2.Codigo = PT.Codigo), 0)) AS Cantidad_Existente
FROM 
    PRODUCTO_TERMINADO PT

--4
SELECT c.ID, c.Nombre, u.Codigo, u.Tipo, u.Caracteristicas
FROM COLEGIO c
JOIN UNIFORME u ON c.ID = u.Id_Colegio;

5)
SELECT COLEGIO.Nombre, UNIFORME.Tipo, UNIFORME.Caracteristicas
FROM COLEGIO
INNER JOIN UNIFORME ON COLEGIO.Id = UNIFORME.Id_Colegio
WHERE COLEGIO.Nombre = 'Colegio A'

6)
SELECT COLEGIO.Nombre,COUNT(PRODUCTO_TERMINADO.Codigo) AS Total_Productos_Vendidos
FROM COLEGIO
INNER JOIN UNIFORME ON COLEGIO.Id = UNIFORME.Id_Colegio
INNER JOIN PRODUCTO_TERMINADO ON UNIFORME.Codigo = PRODUCTO_TERMINADO.Codigo
WHERE PRODUCTO_TERMINADO.Num_pedido IN (SELECT Num_pedido FROM PEDIDO WHERE Estado = 'Entregado')
GROUP BY COLEGIO.Nombre
